## 3장 시스템 설계 면접 공략법

```
논의 주제)
저는 이런 면접을 준비하기 위해 평소에도 내가 알고 있는 것에 대해 설명을 잘 하는 훈련을 하는 게 좋다고 보는 입장입니다.

그래서 평소에도 리뷰에 대한 설명이나 발표에 대한 걸 잘 준비하는게 좋고, 그걸 위해서 어떤 활동을 하는지 혹은 대비하면 좋을지 얘기해 보면 좋겠습니다.

저의 경우는 멘토링 활동을 많이 하다 보니 멘티들이 준비하는 질문에 대해 설명을 어떻게 하면 좋을지 정리해 보고 생각한 다음에 얘기를 해보면서 스스로 피드백을 받아 보는 편입니다. 말을 하다 보면 필요한 내용이 더 떠올라서 얘기해주기도 하고 쓸데없는 걸 많이 얘기하고 있다는 것도 느껴지기도 하거든요. 그걸 잘 리뷰/회고 해서 정제하고 다음 멘토링 때 더 잘 하기 위해 말하는 훈련을 하고 있습니다.
```

회사 면접에서 "시스템 설계 면접" 항목이 있으면 불편하고 당황스러울 수 있다.
하지만 시스템 면접은 두 명의 동료가 모호한 문제를 풀기 위해 협력하여 그 해결책을 찾아내는 과정에 대한 시뮬레이션이다.
이 문제에 정해진 정답은 없다. 이 면접은 설계 기술을 시연하는 자리고 그 과정에서 내린 결정들에 대한 방어 능력을 보이는 자리이며 면접관의 피드백을 건설적인 방식으로 처리할 자질이 있음을 보이는 자리이다.

시스템 설계 면접은 지원자의 설계 능력의 기술적 측면을 평가하는 자리일 수 있지만 그 이상의 것을 평가한다.
지원자가 협력에 적합한 사람인지,
압박이 심한 상황도 잘 헤쳐 나갈 자질이 있는지,
모호한 문제를 건설적으로 해결할 능력이 있는지,
좋은 질문을 던질 능력이 있는지도 중요하다.

면접관은 부정적 신호(red flag)를 놓치지 않는다.
설계의 순수성에 집착하여 트레이드오프를 무시하고 오버 엔지니어링을 하는 엔지니어들이 현업에 많고,
그 결과로 시스템의 비용이 전반적으로 올라가는데, 회사들이 그 대가를 비싸게 치르고 있다.
면접자는 그런 엔지니어의 모습으로 비춰져서는 안된다.

이것 외에 완고함, 편협함 등이 부정적 신호이다.

### 효과적 면접을 위한 4단계 접근법

훌륭한 설계 면접은 정해진 결말도 없고 정답도 없다.
하지만 그 절차나 범위에는 공통적인 부분이 있다.

#### 1단계 문제 이해 및 설계 범위 확정

모든 문제의 답을 빨리 알아내고 1등으로 풀고 시험장을 나가는 학생 스타일이 있는데...
면접장에서는 그런 사람이 되어서는 안된다.

면접은 생각 없이 바로 답을 내서는 좋은 점수를 받기 어렵다.
요구사항을 이해하지 않고 답을 내놓는 행위는 아주 엄청난 부정적 신호이다.

속도를 늦추고 깊이 생각하고 질문해서 요구사항과 가정들을 분명히 해야 한다.
엔지니어는 어려운 문제를 풀고 최종 설계를 바로 내놓고 싶어지는데, 그러면 잘못된 시스템을 설계할 가능성이 높아진다.
엔지니어는 올바른 질문을 하고, 적절한 가정을 하는 것, 그리고 시스템 구축에 필요한 정보를 모으는 것이다.

따라서 요구사항을 이해하는데 있어서 필요한 질문을 해야 한다.
아래와 같은 질문을 생각해 볼 필요가 있다.

- What specific features are we going to build?
- How many users does the product have?
- How fast does the company anticipate to scale up? What are the anticipated scales in 3 months, 6 months, and a year?
- What is the company’s technology stack? What existing services you might leverage to simplify the design?

**예제**

뉴스 피드의 시스템을 설계하는 과정에서 대화를 해야 하는데 몇 가지 중요한 점을 질문해야 한다.

- 모바일 앱인지 웹 앱인지, 혹은 둘 다인지.
- 뉴스 피드에서 시간 순 정렬이 필요한지 혹은 다른 기준이 있어야 하는지.
- 친구를 맺을 수 있는 최대 사용자 수
- 트래픽 규모에 대한 추정
- 피드에 이미지, 비디오, 텍스트에 대한 기준 확인

#### 2단계 개략적인 설계안 제시 및 동의 구하기

개략적인 설계안을 제시하고 면접관의 동의를 얻는 것이다. 그리고 면접관과 협력하며 진행하면 좋다.

- 면접관을 팀원처럼 생각하자. 훌륭한 면접관은 지원자들과 대화하고 설계 과정에 개입하기를 즐긴다.
- 화이트보드나 종이에 핵심 컴포넌트를 포함하는 다이어그램을 그리자.
- 설계안이 시스템 규모에 관계된 제약사항을 만족하는지 체크해 보자. 

구체적 사용 사례도 몇 가지 살펴보면서 설계안을 잡아나가고, 미처 고려하지 못한 에지 케이스(edge case)를 발견하자.
API endpoint나 database schema도 정해야 하는지는 면접관의 의견을 물어보면 좋다.
규모에 따라 구글 검색 엔진 설계라면 너무 세부적일 수 있고
포커 게임 백엔드라면 괜찮을 수 있다.

**예제**

뉴스 피드 시스템 설계에서 개략적으로는 피드 발행(feed publishing)과 피드 생성(feed building)의 두 가지 처리 플로우를 생각할 수 있다.

그러면 아래 그림 처럼 피드 발행과 피드 생성 플로우를 개략적으로 그려볼 수 있다.

<img width="324" alt="image" src="https://github.com/jongfeel/BookReview/assets/17442457/5a893366-7820-4a8b-9163-57ab22ebfc4e">
<img width="287" alt="image" src="https://github.com/jongfeel/BookReview/assets/17442457/cf4d40e4-5537-473e-bd8a-6116a9eea8c1">

#### 3단계 상세 설계

이 단계까지라면 다음 목표를 달성한 상태라고 볼 수 있다.

- Agreed on the overall goals and feature scope
- Sketched out a high-level blueprint for the overall design
- Obtained feedback from your interviewer on the high-level design
- Had some initial ideas about areas to focus on in deep dive based on her feedback

똑같은 면접이란 있을 수 없다.

면접관에 따라 선임급 개발자 면접이라면 시스템 성능 특성을 볼 것이다.
특정 시스템 컴포넌트의 세부 사항을 깊이 있게 설명하는 걸 보길 원할 수 있다.
URL 단축 생성기라면 해시 함수 설계에 대한 설명을 해야 할 수 있고
채팅 시스템이라면 지연 시간과 온/오프라인 상태 표시에 대한 설명을 해야 할 수 있다.

면접 시간 관리도 중요하다.
세부 사항을 설명하는데 시간을 많이 써서 정작 중요한 걸 보여줄 시간이 없어 기회를 놓칠 수도 있다.
면접관에게는 긍정적 신호를 전달하는데 집중해야 하며 불필요한 세부 사항에 시간을 쓰면 안된다.

**예제**

뉴스 피드 시스템에서 피드 발행과 뉴스 피드 가져오기에 대한 깊이 있는 용례를 탐구해야 할 수 있다.
아래 그림은 그에 대한 상세 설계이다.

<img width="474" alt="image" src="https://github.com/jongfeel/BookReview/assets/17442457/a0911619-d198-4269-a102-91cf04fef1df">
<img width="411" alt="image" src="https://github.com/jongfeel/BookReview/assets/17442457/0b1d45dd-a5d4-4c70-a8f3-44cecf64687e">

#### 4단계 마무리

이제 설계 결과를 보고 몇 가지 후속 질문을 던질 수 있고, 스스로 추가 논의를 진행하도록 할 수 있다.
아래 몇 가지 지침을 활용하면 좋다.

- 시스템 병목 구간이나, 개선 포인트를 찾아내라고 할 수 있다. 완벽한 설계라서 없다고 하지 말자, 개선점은 항상 있다.
- 설계에 대한 요약을 하면서 해결책을 제시하면 좋다. 긴 시간 면접을 진행한 면접관에게 기억을 환기시켜줄 수 있다.
- 오류가 발생하면 어떤 일이 일어나는지 살펴보면 좋을 수 있다.
- 운영 이슈도 논의할 가치가 있다. 메트릭 수집, 모니터링, 로그, 배포 전략 등이다.
- 규모 확장 요구에 대해 어떻게 대처할지도 얘기하면 좋을 수 있다. 백만 사용자는 될 것 같지만 천만 사용자라면 어떻게 할지 얘기해 보자
- 필요하지만 다루지 못했던 개선 사항을 제안해 볼 수도 있다.

**해야 할 것**

- 질문을 통해 확인하라.
- 문제의 요구사항을 이해하라.
- 정답이나 최선의 답은 없다.
- 면접관과 소통하고 나의 사고 흐름을 이해할 수 있도록 한다.
- 여러 해법을 함께 제시한다.
- 개략적 설계에 동의를 얻은 후에 중요한 컴포넌트 부터 세부 사항을 설명한다.
- 면접관을 팀원으로 여기고 아이디어를 이끌어 낸다.
- 포기하지 말자.

**하지 말아야 할 것**

- 전형적인 면접 문제들에도 대비하지 않은 상태면 안된다.
- 요구사항이나 가정들을 분명히 하지 않은 상태에서 설계를 제시하지 말자.
- 처음부터 특정 컴포넌트의 세부 사항을 깊게 설명하지 말자.
- 중간에 막히면 힌트를 달라고 하자.
- 면접관과 소통을 해야 한다. 혼자 설계를 진행하지 말자.
- 면접관이 끝났다고 말하기 전까지 끝난 것이 아니다. 의견을 자주 구하자.

#### 시간 배분

45분의 시간이 주어진다고 가정하면 어느 정도 시간을 쓰는 것이 좋을지에 대한 가이드라인이 있다.
이건 추정치일 뿐이고, 실제 써야 하는 시간은 문제의 범위와 면접관의 요구사항에 따라 달라진다.

- 1단계 - 문제 이해 및 설계 범위 확정: 3분 ~ 10분
- 2단계 - 개략적 설계안 제시 및 동의 구하기: 10분 ~ 15분
- 3단계 - 상세 설계: 10분 ~ 25분
- 4단계 - 마무리: 3분 ~ 5분