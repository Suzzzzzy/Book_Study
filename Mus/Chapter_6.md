[ToC]

## 6장 - 키-값 저장소 설계
### 문제 이해 및 설계 범위 확정
- 요러코롬 특성을 갖는 키-값 저장소를 설계
### 단일 서버 키-값 저장소
- 하나만 사용
- 문제 해결해야 함
  - 데이터 압축
  - 자주 쓰는 데이터만 메모리에 두고 나머지는 디스크 저장
  - 그냥 분산 키-값 저장소를 사용해랏

### 분산 키-값 저장소
| CAP 정리(데이터 일관성(consistency), 가용성(availability), 파티션 감내(partition tolerance))!!!
- 데이터 일관성: 어떤 노드에서든지 같은 데이터를 봐야함
- 가용성: 장애가 발생해도 항상 응답 받을 수 있어야함
- 파티션 감내: 통신 장애가 발생하더라도 시스템은 계속 동작
- CP 시스템: 가용성을 희생
- AP 시스템: 데이터 일관성 희생
- CA 시스템: 파티션 문제를 감내하는 것이지만 네트워크 장애는 피할 수 없으므로 요 시스템은 없음
  - 어딜가나 네트워크 장애는 있구나..
- 일관성 모델
  - 강한 일관성: 모든 읽기 연산은 가장 최근에 갱신된 결과를 반환
  - 약한 일관성: 읽기 연산은 가장 최근에 갱신된 결과를 반환하지 못할 수 있음
  - 결과적 일관성: 갱신 결과가 모든 사본에 동기화
- 비 일관성 해소
  - 데이터 버저닝
  - 벡터 시계
  - 내가 이해한 것
    - 서버에 버전 값으로 묶음
    - 있으면 버전 증가 없으면 1 할당
    - 여러 서버에서 읽었을 때, 버전값이 같으면 충돌남
    - 장애를 감지해야 함
      - 여러 노드에서 확인하여 장애를 감지 -> 서버가 많으면 비효율적
      - 가십 프로토콜
        - 헐트비트를 쌍으로 넣어서 주기적으로 확인
        - 지정시간 동안 갱신되지 않으면 해당 노드가 죽음
    - 이를 조치해야 함 -> **여러번 읽어도 잘 모르겠음다!!! 도움!!!!**
      - 엄격한 정족수
      - 느슨한 정족수
      - 후임시 위탁
      - 반 엔트로피
      - 머클 트리
        - 대충 이해한 것
          - 키를 균등하게 넣고
          - 해시 값을 넣고 그걸로 노드를 만듬
          - 또 그걸로 부모 노드에 해시값을 넣어서 이진 트리 형식으로 계속 위로 넣음
- 멘붕!!!
## 함께 논의하고 싶은 주제
- 이거 6장 가지고 서로 이해한 걸 공유하는 시간을 진득하게 갖고 싶습니다.
