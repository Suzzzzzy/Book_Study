[ToC]

## 4장 - 처리율 저장 장치의 설계

### 1단계 - 문제 이해 및 설계 범위 확정
- 처리율 저장 장치를 설계하는데 다양한 알고리즘을 사용할 수 있음
- 소통을 통해 어떠한 장치를 구현할지 정함
- 요구 사항을 요약

### 2단계 - 개략적 설계안 제시 및 동의 구하기
- 처리율 제한 장치는 어디에 둘 것인가?
  - 클라이언트는 젠젠쟈나이
  - 서버측에 둬야함
  - 미들웨어에 둘 수 있지만...
  - 클라우드 마이크로서비스의 경우, 처리율 제한 장치는 보통 [API 게이트웨이](./Glossary.md#4장)라 불리는 컴포넌트에 구현
  - 어디에 둘지 정하는 몇가지 지침
    - 기술언어
    - 알고리즘 찾기
    - 설계에 맞추기
    - 구현 리소스가 없으면 API 게이트웨이 써라
- 처리율 제한 알고리즘
  - 토큰 버킷(token bucket)
    - 이해하기 쉬워서 가장 많이 씀
    - 동작원리(3줄 요약)
      - 버킷 용량을 지정하고
      - 버킷에 토큰을 담아서 하나씩 빼서 처리하다가
      - 가득 차면 버림
    - 2개 파라미터
      - 버킷 크기
      - 토큰 공급률: 초당 몇 개의 토큰이 버킷에 공급되는가
    - 장점
      - 쉬움
      - 메모리 사용 측면 효율적
      - 짧은 시간에 집중되는 트레픽(burst of traffic)도 처리 가능
    - 단점
      - 2개 파라미터를 적적하게 튜닝하는 것은 까다로움
  - 누출 버킷(leacy bucket)
    - 토큰 버킷과 비슷하지만 FIFO 큐로 구현
      - 동작원리(3줄 요약)
        - 큐에 빈자리 있으면 요청 추가하고
        - 가득차 있으면 요청 버리면서
        - 처리 시간마다 큐에서 요청을 꺼내서 처리
      - 2개의 파라미터
        - 버킷 크기
        - 처리율
      - 장점
        - 메모리 사용량 측면에서 효율적
        - 고정된 처리율 -> 안정적 츌력
      - 단점
        - 트래픽 몰리면 요청 버려지는게 많음
        - 튜닝 까다로움
  - 고정 윈도 카운터(fixed window counter)
  - 이동 윈도 로그(sliding window log)
  - 이동 윈도 카운터(sliding window counter)
  

## 함께 논의하고 싶은 주제
- 